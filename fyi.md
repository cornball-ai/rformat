<!-- Generated by fyi::use_fyi_md() on 2026-02-20 -->
<!-- Regenerate with: fyi::use_fyi_md("rformat") -->

# fyi: rformat

## Exported Functions (rformat::)

| Function | Arguments |
|----------|-----------|
| `rformat` | code, indent, wrap, expand_if, brace_style, line_limit |
| `rformat_dir` | path, recursive, dry_run, indent, wrap, expand_if, brace_style, line_limit |
| `rformat_file` | path, output, dry_run, indent, wrap, expand_if, brace_style, line_limit |


## Internal Functions (rformat:::)

| Function | Arguments |
|----------|-----------|
| `add_control_braces` | code |
| `add_one_control_brace` | code |
| `collapse_calls` | code |
| `collapse_one_call` | code |
| `extract_expr_text` | lines, tokens, target_indent |
| `fix_else_placement` | code |
| `format_blank_lines` | code |
| `format_line_tokens` | tokens |
| `format_tokens` | code, indent, wrap, expand_if, brace_style, line_limit |
| `needs_space` | prev, tok |
| `reformat_function_defs` | code, wrap, brace_style, line_limit |
| `reformat_inline_if` | code, line_limit |
| `reformat_one_function` | code, wrap, brace_style, line_limit |
| `reformat_one_inline_if` | code, line_limit |
| `wrap_long_calls` | code, line_limit |
| `wrap_long_operators` | code, line_limit |
| `wrap_one_long_call` | code, line_limit |
| `wrap_one_long_operator` | code, line_limit |


## Options

No options found in `rformat`.



# Documentation: rformat

## add_control_braces

### Add Braces to One-Liner Control Flow

#### Description

Adds braces to single-statement `if`, `for`, `while` bodies:
`if (x) y` becomes `if (x) { y }`.
Does not modify `if`/`else` used as expressions (value-producing).

#### Usage

```r
add_control_braces(code)
```

#### Arguments

- **`code`**: Code string.

#### Value

Code with braces added.


## add_one_control_brace

### Add Braces to One Control Flow Statement

#### Description

Add Braces to One Control Flow Statement

#### Usage

```r
add_one_control_brace(code)
```

#### Arguments

- **`code`**: Code string.

#### Value

Modified code or NULL if no changes.


## collapse_calls

### Collapse Multi-Line Function Calls

#### Description

Collapses function calls spanning multiple lines into a single line.
Long lines are re-wrapped by `wrap_long_calls()` afterward. For example:
c(x,
y,
z
)
becomes `c(x, y, z)`.

#### Usage

```r
collapse_calls(code)
```

#### Arguments

- **`code`**: Formatted code string.

#### Value

Code with collapsed function calls.


## collapse_one_call

### Collapse One Multi-Line Function Call

#### Description

Finds the first multi-line function call that can fit on one line
and collapses it. Skips calls containing comments.

#### Usage

```r
collapse_one_call(code)
```

#### Arguments

- **`code`**: Code string.

#### Value

Modified code or NULL if no changes.


## extract_expr_text

### Extract Expression Text from Source Lines

#### Description

Extract original text for a multi-line expression and re-indent it.

#### Usage

```r
extract_expr_text(lines, tokens, target_indent)
```

#### Arguments

- **`lines`**: Source code lines.
- **`tokens`**: Token data frame for the expression.
- **`target_indent`**: Target indentation string for continuation lines.

#### Value

Expression text with first line unindented, continuation lines re-indented.


## fix_else_placement

### Fix Else Placement

#### Description

Ensures `else` appears on the same line as the closing brace:

else 
becomes `

#### Usage

```r
fix_else_placement(code)
```

#### Arguments

- **`code`**: Code string.

#### Value

Code with corrected else placement.


## format_blank_lines

### Format Blank Lines

#### Description

Normalize blank lines between code blocks.

#### Usage

```r
format_blank_lines(code)
```

#### Arguments

- **`code`**: Code string.

#### Value

Code with normalized blank lines.


## format_line_tokens

### Format Tokens on a Single Line

#### Description

Format Tokens on a Single Line

#### Usage

```r
format_line_tokens(tokens)
```

#### Arguments

- **`tokens`**: Data frame of tokens for one line.

#### Value

Formatted line content (no leading whitespace).


## format_tokens

### Format R Code Using Token-Based Parsing

#### Description

Internal function to format R code using getParseData tokens.
Calculates proper indentation based on nesting depth.

#### Usage

```r
format_tokens(
  code,
  indent = 4L,
  wrap = "paren",
  expand_if = FALSE,
  brace_style = "kr",
  line_limit = 80L
)
```

#### Arguments

- **`code`**: Character string of R code.
- **`indent`**: Integer for spaces (default 4), or character string for
literal indent (e.g., `"\t\t"` for vintage R Core style).
- **`wrap`**: Continuation style: `"paren"` (default) aligns to opening
parenthesis, `"fixed"` uses 8-space indent.
- **`expand_if`**: Expand inline if-else to multi-line (default FALSE).
- **`brace_style`**: Brace placement: `"kr"` (same line) or `"allman"` (new line).
- **`line_limit`**: Maximum line length before wrapping (default 80).

#### Value

Formatted code as character string.


## needs_space

### Determine If Space Needed Between Tokens

#### Description

Determine If Space Needed Between Tokens

#### Usage

```r
needs_space(prev, tok)
```

#### Arguments

- **`prev`**: Previous token (data frame row).
- **`tok`**: Current token (data frame row).

#### Value

Logical.


## reformat_function_defs

### Reformat Function Definitions

#### Description

Ensures function definitions follow style guide:
- Short signatures on one line
- Long signatures wrap with continuation indent
- Brace on same line (K&R) or own line (Allman)

#### Usage

```r
reformat_function_defs(
  code,
  wrap = "paren",
  brace_style = "kr",
  line_limit = 80L
)
```

#### Arguments

- **`code`**: Formatted code string.
- **`wrap`**: Continuation style: `"paren"` or `"fixed"`.
- **`brace_style`**: Brace placement: `"kr"` (same line) or `"allman"` (new line).
- **`line_limit`**: Maximum line length before wrapping (default 80).

#### Value

Code with reformatted function definitions.


## reformat_inline_if

### Reformat Inline If-Else Statements

#### Description

Expands inline if-else to multi-line format per style guide:
x <- if (cond) a else b
becomes:
if (cond) {
x <- a
} else {
x <- b

#### Usage

```r
reformat_inline_if(code, line_limit = 0L)
```

#### Arguments

- **`code`**: Formatted code string.

#### Value

Code with reformatted inline if-else.


## reformat_one_function

### Reformat One Function Definition

#### Description

Uses R Core continuation style: args on one line if they fit,
otherwise wrap with continuation indent.

#### Usage

```r
reformat_one_function(
  code,
  wrap = "paren",
  brace_style = "kr",
  line_limit = 80L
)
```

#### Arguments

- **`code`**: Code string.
- **`wrap`**: Continuation style: `"paren"` aligns to opening parenthesis,
`"fixed"` uses 8-space indent.
- **`brace_style`**: Brace placement: `"kr"` (same line) or `"allman"` (new line).
- **`line_limit`**: Maximum line length before wrapping (default 80).

#### Value

Modified code or NULL if no changes.


## reformat_one_inline_if

### Reformat One Inline If-Else Statement

#### Description

Reformat One Inline If-Else Statement

#### Usage

```r
reformat_one_inline_if(code, line_limit = 0L)
```

#### Arguments

- **`code`**: Code string.
- **`line_limit`**: Only expand if-else on lines exceeding this limit.
Use 0 to expand all inline if-else.

#### Value

Modified code or NULL if no changes.


## rformat_dir

### Format R Files in Directory

#### Description

Format all R files in a directory.

#### Usage

```r
rformat_dir(
  path = ".",
  recursive = TRUE,
  dry_run = FALSE,
  indent = 4L,
  wrap = "paren",
  expand_if = FALSE,
  brace_style = "kr",
  line_limit = 80L
)
```

#### Arguments

- **`path`**: Path to directory.
- **`recursive`**: If TRUE, process subdirectories.
- **`dry_run`**: If TRUE, report changes without writing.
- **`indent`**: Indentation per level: integer for spaces (default 4), or
character string for literal indent (e.g., `"\t\t"` for vintage R Core style).
- **`wrap`**: Continuation style for long function signatures: `"paren"`
(default) aligns to opening parenthesis, `"fixed"` uses 8-space indent.
- **`expand_if`**: Expand inline if-else to multi-line (default FALSE).
- **`brace_style`**: Brace placement for function definitions: `"kr"` (default)
puts opening brace on same line as `) {`, `"allman"` puts it on a new line.
- **`line_limit`**: Maximum line length before wrapping (default 80).

#### Value

Invisibly returns vector of modified file paths.

#### Examples

```r
# Format all R files in a directory (dry run)
d <- tempfile()
dir.create(d)
writeLines("x<-1", file.path(d, "test.R"))
rformat_dir(d, dry_run = TRUE)

# Format and overwrite
rformat_dir(d)
unlink(d, recursive = TRUE)
```


## rformat_file

### Format R File

#### Description

Format an R file in place or write to a new file.

#### Usage

```r
rformat_file(
  path,
  output = NULL,
  dry_run = FALSE,
  indent = 4L,
  wrap = "paren",
  expand_if = FALSE,
  brace_style = "kr",
  line_limit = 80L
)
```

#### Arguments

- **`path`**: Path to R file.
- **`output`**: Optional output path. If NULL, overwrites input file.
- **`dry_run`**: If TRUE, return formatted code without writing.
- **`indent`**: Indentation per level: integer for spaces (default 4), or
character string for literal indent (e.g., `"\t\t"` for vintage R Core style).
- **`wrap`**: Continuation style for long function signatures: `"paren"`
(default) aligns to opening parenthesis, `"fixed"` uses 8-space indent.
- **`expand_if`**: Expand inline if-else to multi-line (default FALSE).
- **`brace_style`**: Brace placement for function definitions: `"kr"` (default)
puts opening brace on same line as `) {`, `"allman"` puts it on a new line.
- **`line_limit`**: Maximum line length before wrapping (default 80).

#### Value

Invisibly returns formatted code.

#### Examples

```r
# Format a file (dry run to see result without writing)
f <- tempfile(fileext = ".R")
writeLines("x<-1+2", f)
rformat_file(f, dry_run = TRUE)

# Format and overwrite
rformat_file(f)
readLines(f)
unlink(f)
```


## rformat

### Format R Code

#### Description

Format R code string according to base R style conventions.

#### Usage

```r
rformat(
  code,
  indent = 4L,
  wrap = "paren",
  expand_if = FALSE,
  brace_style = "kr",
  line_limit = 80L
)
```

#### Arguments

- **`code`**: Character string of R code to format.
- **`indent`**: Indentation per level: integer for spaces (default 4), or
character string for literal indent (e.g., `"\t\t"` for vintage R Core style).
- **`wrap`**: Continuation style for long function signatures: `"paren"`
(default) aligns to opening parenthesis, `"fixed"` uses 8-space indent.
- **`expand_if`**: Expand inline if-else to multi-line (default FALSE).
- **`brace_style`**: Brace placement for function definitions: `"kr"` (default)
puts opening brace on same line as `) {`, `"allman"` puts it on a new line.
- **`line_limit`**: Maximum line length before wrapping (default 80).

#### Value

Formatted code as a character string.

#### Examples

```r
rformat("x<-1+2")
rformat("if(x>0){y<-1}")
# Expand inline if-else
rformat("x <- if (a) b else c", expand_if = TRUE)
# Allman brace style (legacy)
rformat("f <- function(x) { x }", brace_style = "allman")
```


## wrap_long_calls

### Wrap Long Function Calls

#### Description

Wraps function call lines that exceed the line limit by breaking at commas.
Continuation lines are aligned to the opening parenthesis.

#### Usage

```r
wrap_long_calls(code, line_limit = 80L)
```

#### Arguments

- **`code`**: Formatted code string.
- **`line_limit`**: Maximum line length (default 80).

#### Value

Code with wrapped long calls.


## wrap_long_operators

### Wrap Long Lines at Operators

#### Description

Wraps lines exceeding the line limit at logical operators (`||`, `&&`)
with continuation aligned to the first operand.

#### Usage

```r
wrap_long_operators(code, line_limit = 80L)
```

#### Arguments

- **`code`**: Formatted code string.
- **`line_limit`**: Maximum line length (default 80).

#### Value

Code with wrapped long lines.


## wrap_one_long_call

### Wrap One Long Function Call

#### Description

Finds the first single-line function call that exceeds the line limit
and wraps it at commas with paren-aligned continuation.

#### Usage

```r
wrap_one_long_call(code, line_limit = 80L)
```

#### Arguments

- **`code`**: Code string.
- **`line_limit`**: Maximum line length (default 80).

#### Value

Modified code or NULL if no changes.


## wrap_one_long_operator

### Wrap One Long Line at an Operator

#### Description

Finds the first line exceeding the limit that contains a top-level
logical operator and wraps there. The operator stays at the end of the
first line, continuation is aligned to the first operand.

#### Usage

```r
wrap_one_long_operator(code, line_limit = 80L)
```

#### Arguments

- **`code`**: Code string.
- **`line_limit`**: Maximum line length (default 80).

#### Value

Modified code or NULL if no changes.


